@model IEnumerable<projetoTP3_A2.Controllers.PacienteListItem>
@{
    ViewData["Title"] = "Pacientes";
    Layout = "_Layout";
}

<style>
    .btn-pesquisar {
        background-color: #14A091;
        color: #fff;
        border: none;
    }
    .btn-pesquisar:hover {
        background-color: #118072;
        color: #fff;
    }
    .table-custom thead th {
        background-color: #D0F5F2 !important;
        color: #14A091 !important;
    }
    .table-custom tbody td {
        background-color: #E7FDFB !important;
        color: #14A091 !important;
    }
    .table-custom tbody tr:hover td {
        background-color: #C4ECE9 !important;
        color: #14A091 !important;
    }
</style>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-2">
            <partial name="_Sidebar" />
        </div>
        <div class="col-md-10">
            <h2 style="color:#14A091;" class="mb-4">Pacientes</h2>

            <form method="get" class="d-flex mb-3">
                <input type="text" name="query" value="@Context.Request.Query["query"]"
                       class="form-control me-2" placeholder="Buscar por nome..." />

                <select name="pageSize" class="form-select me-2" style="width:120px;" onchange="this.form.submit()">
                    <option value="10" selected="@(ViewBag.PageSize == 10)">10</option>
                    <option value="20" selected="@(ViewBag.PageSize == 20)">20</option>
                    <option value="50" selected="@(ViewBag.PageSize == 50)">50</option>
                </select>

                <button type="submit" class="btn btn-sm btn-pesquisar">Pesquisar</button>
            </form>

            <table class="table table-hover border rounded shadow-sm table-custom">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var p in Model)
                    {
                        <tr>
                            <td>@p.Nome</td>
                            <td>@p.Email</td>
                            <td>
                                <a asp-controller="Medico" asp-action="Prontuario" asp-route-id="@p.Id"
                                   class="btn btn-sm btn-details">Ver prontuário</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>

            <!-- Paginação -->
            <nav>
                <ul class="pagination">
                    @{
                        int totalPages = (int)Math.Ceiling((double)ViewBag.TotalCount / ViewBag.PageSize);
                        int currentPage = ViewBag.Page;

                        // Botão anterior
                        if (currentPage > 1)
                        {
                            <li class="page-item">
                                <a class="page-link"
                                   href="@Url.Action("Pacientes", new { page = currentPage - 1, pageSize = ViewBag.PageSize, query = Context.Request.Query["query"] })">
                                    « Anterior
                                </a>
                            </li>
                        }

                        // Números
                        for (int i = 1; i <= totalPages; i++)
                        {
                            <li class="page-item @(i == currentPage ? "active" : "")">
                                <a class="page-link"
                                   href="@Url.Action("Pacientes", new { page = i, pageSize = ViewBag.PageSize, query = Context.Request.Query["query"] })">
                                    @i
                                </a>
                            </li>
                        }

                        // Botão próximo
                        if (currentPage < totalPages)
                        {
                            <li class="page-item">
                                <a class="page-link"
                                   href="@Url.Action("Pacientes", new { page = currentPage + 1, pageSize = ViewBag.PageSize, query = Context.Request.Query["query"] })">
                                    Próxima »
                                </a>
                            </li>
                        }
                    }
                </ul>
            </nav>
        </div>
    </div>
</div>