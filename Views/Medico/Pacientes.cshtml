@model IEnumerable<projetoTP3_A2.Controllers.PacienteListItem>
@{
    ViewData["Title"] = "Pacientes";
}

<style>
    .btn-pesquisar {
        background-color: #14A091;
        color: #fff;
        border: none;
    }

        .btn-pesquisar:hover {
            background-color: #118072;
            color: #fff;
        }

    .table-custom thead th {
        background-color: #D0F5F2 !important;
        color: #14A091 !important;
        border-bottom: 2px solid #14A091;
    }

    .table-custom tbody td {
        background-color: #E7FDFB !important;
        color: #273240 !important;
        vertical-align: middle;
    }

    .table-custom tbody tr:hover td {
        background-color: #C4ECE9 !important;
    }

    .btn-details {
        background-color: #14A091;
        color: #fff;
        border: none;
    }

        .btn-details:hover {
            background-color: #118072;
            color: #fff;
        }

    .pagination .page-link {
        color: #14A091;
        border-color: #14A091;
    }

    .pagination .page-item.active .page-link {
        background-color: #14A091;
        border-color: #14A091;
        color: #fff;
    }
</style>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <h2 class="mb-4 text-uppercase fw-bold" style="color:#14A091;">Pacientes</h2>

            <form method="get" class="row g-2 mb-4 align-items-center">
                <div class="col-md-6">
                    <input type="text" name="query" value="@Context.Request.Query["query"]"
                           class="form-control" placeholder="Buscar por nome..." />
                </div>
                <div class="col-md-2">
                    <select name="pageSize" class="form-select" onchange="this.form.submit()">
                        <option value="10" selected="@(ViewBag.PageSize == 10)">10</option>
                        <option value="20" selected="@(ViewBag.PageSize == 20)">20</option>
                        <option value="50" selected="@(ViewBag.PageSize == 50)">50</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-pesquisar w-100">Pesquisar</button>
                </div>
            </form>

            <div class="table-responsive shadow-sm rounded">
                <table class="table table-hover table-custom">
                    <thead class="text-center">
                        <tr>
                            <th>Nome</th>
                            <th>Email</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var p in Model)
                        {
                            <tr>
                                <td>@p.Nome</td>
                                <td>@p.Email</td>
                                <td>
                                    <a asp-controller="Medico" asp-action="VerProntuario" asp-route-pacienteId="@p.Id"
                                       class="btn btn-sm btn-details">Ver prontuário</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            <!-- Paginação -->
            <nav class="mt-4">
                <ul class="pagination justify-content-center">
                    @{
                        int totalPages = (int)Math.Ceiling((double)ViewBag.TotalCount / ViewBag.PageSize);
                        int currentPage = ViewBag.Page;

                        if (currentPage > 1)
                        {
                            <li class="page-item">
                                <a class="page-link"
                                   href="@Url.Action("Pacientes", new { page = currentPage - 1, pageSize = ViewBag.PageSize, query = Context.Request.Query["query"] })">
                                    « Anterior
                                </a>
                            </li>
                        }

                        for (int i = 1; i <= totalPages; i++)
                        {
                            <li class="page-item @(i == currentPage ? "active" : "")">
                                <a class="page-link"
                                   href="@Url.Action("Pacientes", new { page = i, pageSize = ViewBag.PageSize, query = Context.Request.Query["query"] })">
                                    @i
                                </a>
                            </li>
                        }

                        if (currentPage < totalPages)
                        {
                            <li class="page-item">
                                <a class="page-link"
                                   href="@Url.Action("Pacientes", new { page = currentPage + 1, pageSize = ViewBag.PageSize, query = Context.Request.Query["query"] })">
                                    Próxima »
                                </a>
                            </li>
                        }
                    }
                </ul>
            </nav>
        </div>
    </div>
</div>